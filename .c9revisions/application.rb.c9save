{"ts":1374023354957,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1374023594711,"patch":[[{"diffs":[[1,"require 'mysql2'\nrequire 'yaml'\nrequire 'fileutils'\nrequire 'csv'\nload 'functions/functions.rb'\nconfig = YAML::load(open(\"#{File.expand_path(File.dirname(__FILE__))}/configs/configs.yml\"))[\"mysql\"]\nclient = Mysql2::Client.new(:host => config[\"host\"], :username => config[\"username\"], :database => config[\"database\"])\n\nfiles = \"*.csv\"\nfiles = Dir.glob files\np files\nclient.query(\"Truncate table Customers\")\nbegin\n  files.each { |file|\n  p file\n    CSV.foreach(file, :headers => :first_row) { |record|\n      p record\n      fname = record[0]\n      lname = record[1]\n      dob = FormatDate.new(record[2]).newMethod\n      #dob = Date.strptime(record[2], \"%m/%d/%Y\").strftime(\"%Y-%m-%d\")\n      age = record[3]\n      #p \"#{fname}, #{lname}, #{dob}, #{age}\"\n      client.query \"Insert into Customers Values('#{fname}', '#{lname}', '#{age}', '#{dob}', '#{Time.now.strftime(\"%Y-%m-%d %H:%M:%S\")}')\"\n    }\n    # File.readlines(\"customers.txt\").map { |records|\n    #   records = records.gsub(\"\\n\", \"\")\n    #   records = records.split(\",\")\n    #   fname = records[0]\n    #   lname = records[1]\n    #   dob = Date.strptime(records[2], \"%m/%d/%Y\").strftime(\"%Y-%m-%d\")\n    #   age = records[3]\n    #   client.query \"Insert into Customers Values('#{fname}', '#{lname}', '#{age}', '#{dob}', '#{Time.now.strftime(\"%Y-%m-%d %H:%M:%S\")}')\"\n    # }\n  }\nrescue Exception => e\n  $message = e.message\n  exit\nend\n\n# if $message == nil\n  files.each{|file| FileUtils.mv(file, \"backups/\")}\n# end\n# alert = []\n# alert << \"Hello\"\n\n# p alert"]],"start1":0,"start2":0,"length1":0,"length2":1510}]],"length":1510,"saved":false}
